# 北京城区水热通量数据分析程序

本程序以样例的方式展示**"北京地区高时空分辨率的水热通量数据集构建"**项目的主要成果，通过提供的主要功能如展示特定时间的通量数据**空间分布**状况，以及分析特定地点的通量数据的**均值，时间序列及其趋势**等，可帮助进一步了解北京城区在2013-2019年的蒸散发、植被生长状况，以及对应的热通量的时空分布。

一个低分辨率(1000m)的高效网页程序实例请见 https://xuzhenwu.shinyapps.io/PML-shiny/

## 1 运行环境

a. 在文件夹**Rapp**中查找安装包，或在网页下载以下软件，按默认选项直接安装

* R4.0.2 <https://www.r-project.org/>
* Rstudio <https://rstudio.com/>
* Rtools开发包 <https://cran.r-project.org/bin/windows/Rtools/>

b. 打开**Rcode**文件夹，双击打开**PML-shiny.Rproj**项目文件

c. 打开**install_packages.R**脚本，勾选左上角**source to save**选项，安装依赖项

c. 打开在**ui.R**或**server.R**，点击右上角**Run App**，在弹出窗口点击**open in browser**在浏览器中运行

## 2 功能和界面

##### 基本功能

* 分析特定时间的通量数据**空间分布**状况
* 分析特定地点的通量数据的**均值，时间序列及其趋势**

##### 界面

* 左侧- 输入和输出模块。输入有三大项，**数据库目录、通量分布、固定站点时间序列分析**。可以修改时间，地点，数据集，重采样的分辨率等选项，并点击每个小块的**应用**选项来确认更新数据可视化模块。
* 中间 - 空间和时间数据可视化模块。上侧为**动态地图**，可查看全局或特定地点的通量数据值。蓝色圆圈表示所选站点在一定空间半径距离下的范围，用于裁剪获取特定地点或区域的通量信息。下侧显示对应的**通量数据时间序列信息**，同时均值和趋势，显著性检验的**输出结果**在左侧模块下方。
* 右侧 - **项目信息和注意事项模块**。

## 3 其他事项

* 原始数据为**10m**分辨率，但在内存有限的计算机请选择低分辨率绘图，默认为**30m**分辨率
* 固定站点是在一定半径范围内获取得通量数据。对于区域分析，可选择粗分辨率；对于单点，可以调低至基本覆盖站点测量范围。
* 数据地理坐标系为WGS1984
* 重新修改应用设置所需时间一般小于1分钟，在修改完成后请点击应用选项完成对应改动

## 4 版权归属

本软件为中国科学院地理与资源研究所受北京市水科院委托而制作，供**#北京地区高时空分辨率的水热通量数据集构建#**项目使用，其最终解释权归**中国科学院地理与资源研究所**所有，未经允许不得用于其他项目以及商业行为。如有疑问请联系15521242747。

## 5 一些存在的小问题

* SH坐标地图无法显示，投影坐标存在问题
* Ei的值均为0
* landcover 应使用category 方式输出
